
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the CEQUEAU hydrological model">
      
      
        <meta name="author" content="CEQUEAU Team">
      
      
        <link rel="canonical" href="https://erinconv.github.io/CEQUEAU/guide/">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Usage - CEQUEAU Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#usage" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="CEQUEAU Documentation" class="md-header__button md-logo" aria-label="CEQUEAU Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CEQUEAU Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Usage
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/erinconv/CEQUEAU" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    CEQUEAU Model
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href=".." class="md-tabs__link">
          
  
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../api/" class="md-tabs__link">
          
  
  
    
  
  API Documentation

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../CEQUEAU/annotated/" class="md-tabs__link">
          
  
  
    
  
  API Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="CEQUEAU Documentation" class="md-nav__button md-logo" aria-label="CEQUEAU Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    CEQUEAU Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/erinconv/CEQUEAU" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    CEQUEAU Model
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href=".." class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    License
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing to CEQUEAU
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../code_of_conduct/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code of Conduct for CEQUEAU Development
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Documentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API Documentation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/simulation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simulation Class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/bassin_versant/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    BassinVersant Class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/carreau_entier/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CarreauEntier Class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/carreau_partiel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CarreauPartiel Class
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CEQUEAU/annotated/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Class List
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">&para;</a></h1>
<p>The function is called in the following way:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c">% General form</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="p">[</span><span class="n">outputs</span><span class="k">...</span><span class="c">] = CequeauQuantiteMex(inputs...);</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c">% Specific example</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">[</span><span class="n">etatsCE</span><span class="p">,</span><span class="w"> </span><span class="n">etatsCP</span><span class="p">,</span><span class="w"> </span><span class="n">etatsFonte</span><span class="p">,</span><span class="w"> </span><span class="n">etatsEvapo</span><span class="p">,</span><span class="w"> </span><span class="n">etatsBarrage</span><span class="p">,</span><span class="w"> </span><span class="n">pasDeTemps</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w"> </span><span class="n">avantAssimilationsCE</span><span class="p">,</span><span class="w"> </span><span class="n">avantAssimilationsFonte</span><span class="p">,</span><span class="w"> </span><span class="n">avanAssimilationEvapo</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w"> </span><span class="n">etatsQualCP</span><span class="p">,</span><span class="w"> </span><span class="n">avAssimQual</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">...</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">    </span><span class="n">CequeauQuantiteMex</span><span class="p">(</span><span class="n">execution</span><span class="p">,</span><span class="w"> </span><span class="n">parametres</span><span class="p">,</span><span class="w"> </span><span class="n">bassinVersant</span><span class="p">,</span><span class="w"> </span><span class="n">meteo</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="w">                       </span><span class="n">etatsPrecedents</span><span class="p">,</span><span class="w"> </span><span class="n">assimilations</span><span class="p">,</span><span class="w"> </span><span class="n">stations</span><span class="p">);</span>
</code></pre></div>
<p>Inputs:</p>
<ul>
<li>
<p>execution</p>
</li>
<li>
<p>parametres</p>
</li>
<li>
<p>bassinVersant</p>
</li>
<li>
<p>meteo</p>
</li>
<li>
<p>etatsPrecedents</p>
</li>
<li>
<p>assimilations</p>
</li>
<li>
<p>stations</p>
</li>
</ul>
<h1 id="execution">Execution<a class="headerlink" href="#execution" title="Permanent link">&para;</a></h1>
<p>The execution struct contains the start and end dates for the
simulation. These dates can be modified to simulate a specific subset of
the overall data range. However, it is important that the input data
matches the specified range.</p>
<p>This is important for:</p>
<ul>
<li>
<p>All <strong>meteo</strong> data</p>
</li>
<li>
<p><strong>barrage</strong> data (bassinVersant.barrage): <strong>debit</strong></p>
</li>
<li>
<p><strong>Puits</strong> data (bassinVersant.puits): <strong>debitPompage</strong> and
    <strong>niveauxPuits</strong></p>
</li>
</ul>
<p>The intersect function in Matlab/Octave
can find the matching date range, which can then be used to extract the
relevant dates, as shown below:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">struct_ex</span><span class="p">.</span><span class="n">execution</span><span class="p">.</span><span class="n">dateDebut</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">datenum</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">struct_ex</span><span class="p">.</span><span class="n">execution</span><span class="p">.</span><span class="n">dateFin</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">datenum</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">);</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="n">dates</span><span class="p">.</span><span class="n">sim</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="n">struct_ex</span><span class="p">.</span><span class="n">execution</span><span class="p">.</span><span class="n">dateDebut</span><span class="p">:</span><span class="n">struct_ex</span><span class="p">.</span><span class="n">execution</span><span class="p">.</span><span class="n">dateFin</span><span class="p">]</span><span class="o">&#39;</span><span class="p">;</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="p">[</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="p">,</span><span class="w"> </span><span class="n">J</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">intersect</span><span class="p">(</span><span class="n">struct_ex</span><span class="p">.</span><span class="n">meteoPointGrille</span><span class="p">.</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">dates</span><span class="p">.</span><span class="n">sim</span><span class="p">);</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="n">struct_ex</span><span class="p">.</span><span class="n">meteoPointGrille</span><span class="p">.</span><span class="n">t</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">struct_ex</span><span class="p">.</span><span class="n">meteoPointGrille</span><span class="p">.</span><span class="n">t</span><span class="p">(</span><span class="n">I</span><span class="p">);</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="n">struct_ex</span><span class="p">.</span><span class="n">meteoPointGrille</span><span class="p">.</span><span class="n">TMin</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">struct_ex</span><span class="p">.</span><span class="n">meteoPointGrille</span><span class="p">.</span><span class="n">TMin</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="w"> </span><span class="p">:);</span>
</code></pre></div>
<h1 id="dli">DLI<a class="headerlink" href="#dli" title="Permanent link">&para;</a></h1>
<p>DLI parameters need to be added within the structure in the latest
version of Cequeau. The <code>.mat</code> file <code>dli_params.mat</code> is included in the
<code>cequeau/tests/mat_files</code> folder.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c">% parametres pour DLI</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="nb">load</span><span class="p">(</span><span class="s">&#39;dli_params.mat&#39;</span><span class="p">);</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="n">structSMA</span><span class="p">.</span><span class="n">parametres</span><span class="p">.</span><span class="n">dli</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">dli_params</span><span class="p">;</span>
</code></pre></div>
<h1 id="pumping">Pumping<a class="headerlink" href="#pumping" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>The pumping module takes into account the water being pumped out of the
ground for each whole square (CE) at each timestep. Pumping data is
provided through data about wells located on the river basin.</p>
<p>To turn on the pumping module, the option must be set to 1. Setting it
to 0 (default) will turn it off.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">StructFinal</span><span class="p">.</span><span class="n">parametres</span><span class="p">.</span><span class="n">option</span><span class="p">.</span><span class="n">modulePompage</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c">% 0 = off, 1 = on</span>
</code></pre></div>
<p>Data about water wells is placed within the <code>bassinVersant</code> struct. Each
well needs to have the index of the CE, the distance from the well to
the river, the initial water level h0, all the water levels and the
pumping rate in m^3^ per day. There is also a variable to
activate/deactivate the well.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c">% Initialize the structure to hold all wells</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">structPuits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">struct</span><span class="p">();</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="n">numTimeSteps</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">size</span><span class="p">(</span><span class="n">meteo</span><span class="p">.</span><span class="n">dates</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c">% Example: Get number of timesteps</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="n">structPuits</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">idCE</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">41</span><span class="p">;</span><span class="w"> </span><span class="c">% index of whole square</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="n">structPuits</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">active</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c">% activate the well</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="n">structPuits</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">distanceRiviere</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c">% distance between well and river (m)</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="n">structPuits</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">h0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span><span class="w"> </span><span class="c">% initial water level (m)</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="n">structPuits</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">niveauxPuits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">ones</span><span class="p">(</span><span class="n">numTimeSteps</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span><span class="w"> </span><span class="c">% water level at each timestep (m)</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="n">structPuits</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">debitPompage</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Debit_Pomp</span><span class="p">.</span><span class="n">Well_1</span><span class="p">;</span><span class="w"> </span><span class="c">% pumping rate m3/day at each timestep</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="n">structPuits</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">idCE</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="n">structPuits</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">active</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c">% deactivate the well</span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="n">structPuits</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">distanceRiviere</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c">% distance between well and river (m)</span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="n">structPuits</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">h0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span><span class="w"> </span><span class="c">% initial water level (m)</span>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="n">structPuits</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">niveauxPuits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">ones</span><span class="p">(</span><span class="n">numTimeSteps</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span><span class="w"> </span><span class="c">% water level at each timestep (m)</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="n">structPuits</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">debitPompage</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Debit_Pomp</span><span class="p">.</span><span class="n">Well_2</span><span class="p">;</span><span class="w"> </span><span class="c">% pumping rate m3/day at each timestep</span>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="n">StructFinal</span><span class="p">.</span><span class="n">bassinVersant</span><span class="p">.</span><span class="n">puits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">structPuits</span><span class="p">;</span>
</code></pre></div>
<p>Other parameters are set within the <code>parametres</code> struct.</p>
<p>The <code>delai</code> parameter delays the effect of the pumping by the given
number of timesteps.</p>
<p>The <code>conductiviteHydraulique_s</code> is used to specify the hydraulic
conductivity. A single value can be given to assign the same values to
all whole squares, or a <code>1 x number of CE</code> array can be provided to assign
a value to each CE.</p>
<p>The <code>coeffPompage</code> is used to adjust the extracted water from the
reservoir (to be calibrated)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c">% creating pumping parameter struct</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="n">StructFinal</span><span class="p">.</span><span class="n">parametres</span><span class="p">.</span><span class="n">pompage</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">struct</span><span class="p">();</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="n">StructFinal</span><span class="p">.</span><span class="n">parametres</span><span class="p">.</span><span class="n">pompage</span><span class="p">.</span><span class="n">delai</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c">% Delay in timesteps</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="n">StructFinal</span><span class="p">.</span><span class="n">parametres</span><span class="p">.</span><span class="n">pompage</span><span class="p">.</span><span class="n">coeffPompage</span><span class="p">=</span><span class="w"> </span><span class="mf">0.01</span><span class="p">;</span><span class="w"> </span><span class="c">% Calibration coefficient</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="c">% Hydraulic conductivity (K) examples:</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="c">% 1) a single value for all CEs</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="n">StructFinal</span><span class="p">.</span><span class="n">parametres</span><span class="p">.</span><span class="n">pompage</span><span class="p">.</span><span class="n">conductiviteHydraulique_s</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c">% m/day</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="c">% 2) a value for each CE, the index indicates the idCE [1 x numCE]</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="n">numCE</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">numel</span><span class="p">(</span><span class="n">StructFinal</span><span class="p">.</span><span class="n">bassinVersant</span><span class="p">.</span><span class="n">carreauxEntiers</span><span class="p">);</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="n">StructFinal</span><span class="p">.</span><span class="n">parametres</span><span class="p">.</span><span class="n">pompage</span><span class="p">.</span><span class="n">conductiviteHydraulique_s</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">numCE</span><span class="p">);</span><span class="w"> </span><span class="c">% m/day</span>
</code></pre></div>
<h3 id="theory-and-equation">Theory and Equation<a class="headerlink" href="#theory-and-equation" title="Permanent link">&para;</a></h3>
<p>To take into account the wells distance from the river, the radius of
influence is calculated for each well during pumping. The following
variables and units are used:</p>
<ul>
<li>Pumped discharge: $Q_i$ [m$^3$/day]</li>
<li>Hydraulic conductivity: $K$ [m/day]</li>
<li>Initial head in the pumping well: $h_0$ [m]</li>
<li>Hydraulic gradient: $\beta$</li>
<li>Radius of influence: $r_0$ [m]</li>
</ul>
<p>$$r_{o} = \frac{Q_{i}}{2\pi Kh_{0}\beta}$$</p>
<p>The hydraulic gradient ($\beta$) is approximated as the mean surface slope of the
whole square.</p>
<p>To adjust the volume of water removed from the reservoir, <code>coeffPompage</code>
($\gamma$) is used:</p>
<p>$$Q_{extracted} = Q_{i} \times (1 - e^{- \gamma r_{o}})$$</p>
<h3 id="pumping-code">Pumping Code<a class="headerlink" href="#pumping-code" title="Permanent link">&para;</a></h3>
<p>The core logic for handling well (<code>Puits</code>) data and pumping calculations can be found primarily within the <code>src/Puits.cpp</code> source file, interacting with the main simulation loop.</p>
<h1 id="shading">Shading<a class="headerlink" href="#shading" title="Permanent link">&para;</a></h1>
<h2 id="overview_1">Overview<a class="headerlink" href="#overview_1" title="Permanent link">&para;</a></h2>
<p>There are two algorithms used to take into account the effects of
shading from trees. To activate and choose the algorithm, the
struct.parametres.option.moduleOmbrage option is used:</p>
<ul>
<li>
<p>moduleOmbrage = 0: No shading algorithm is used.</p>
</li>
<li>
<p>moduleOmbrage = 1: Shading algorithm based on tree height is used.</p>
</li>
<li>
<p>moduleOmbrage = 2: Shading algorithm based on leaf area index (LAI)
    is used.</p>
</li>
</ul>
<h2 id="tree-height-shading-algorithm">Tree Height Shading Algorithm<a class="headerlink" href="#tree-height-shading-algorithm" title="Permanent link">&para;</a></h2>
<h3 id="usage_1">Usage<a class="headerlink" href="#usage_1" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>Set <code>moduleOmbrage = 1</code></p>
</li>
<li>
<p>Add average tree height for each CP:
    <code>struct.bassinVersant.carreauxPartiels.hautMoyenneArbre</code></p>
</li>
</ul>
<p>The following example shows the average tree height for each CP being
set to 12 meters.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">structSMA</span><span class="p">.</span><span class="n">parametres</span><span class="p">.</span><span class="n">option</span><span class="p">.</span><span class="n">moduleOmbrage</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="c">% Assuming structSMA.bassinVersant.carreauxPartiels is already populated</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="c">% Set average tree height to 12m for all CPs</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="p">[</span><span class="n">structSMA</span><span class="p">.</span><span class="n">bassinVersant</span><span class="p">.</span><span class="n">carreauxPartiels</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="k">end</span><span class="p">).</span><span class="n">hautMoyenneArbre</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">deal</span><span class="p">(</span><span class="mi">12</span><span class="p">);</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="c">% Example function call (assuming other structs are defined)</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="p">[</span><span class="n">structSMA</span><span class="p">.</span><span class="n">etatsCE</span><span class="p">,</span><span class="w"> </span><span class="n">structSMA</span><span class="p">.</span><span class="n">etatsCP</span><span class="p">,</span><span class="w"> </span><span class="n">structSMA</span><span class="p">.</span><span class="n">etatsFonte</span><span class="p">,</span><span class="w"> </span><span class="n">structSMA</span><span class="p">.</span><span class="n">etatsEvapo</span><span class="p">,</span><span class="w"> </span><span class="n">structSMA</span><span class="p">.</span><span class="n">etatsBarrage</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w"> </span><span class="n">structSMA</span><span class="p">.</span><span class="n">pasDeTemps</span><span class="p">,</span><span class="w"> </span><span class="n">structSMA</span><span class="p">.</span><span class="n">avantAssimilationsCE</span><span class="p">,</span><span class="w"> </span><span class="n">structSMA</span><span class="p">.</span><span class="n">avantAssimilationsFonte</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w"> </span><span class="n">structSMA</span><span class="p">.</span><span class="n">avantAssimilationsEvapo</span><span class="p">,</span><span class="w"> </span><span class="n">structSMA</span><span class="p">.</span><span class="n">etatsQualCP</span><span class="p">,</span><span class="w"> </span><span class="n">structSMA</span><span class="p">.</span><span class="n">avAssimQual</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">...</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">    </span><span class="n">cequeauQuantiteMex</span><span class="p">(</span><span class="n">structSMA</span><span class="p">.</span><span class="n">execution</span><span class="p">,</span><span class="w"> </span><span class="n">structSMA</span><span class="p">.</span><span class="n">parametres</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="w">                       </span><span class="n">structSMA</span><span class="p">.</span><span class="n">bassinVersant</span><span class="p">,</span><span class="w"> </span><span class="n">structSMA</span><span class="p">.</span><span class="n">meteoPointGrille</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="w">                       </span><span class="p">[],</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="p">[]);</span><span class="w"> </span><span class="c">% Assuming no initial states, etc.</span>
</code></pre></div>
<h3 id="algorithm">Algorithm<a class="headerlink" href="#algorithm" title="Permanent link">&para;</a></h3>
<p>The following is calculated for each partial square (CP)</p>
<ol>
<li>
<p>Extract data: latitude, longitude, river width, orientation of the
    river, tree height, and date.</p>
</li>
<li>
<p>Calculate solar position using SPA algorithm (<a href="https://midcdmz.nrel.gov/spa/#agree">NREL's Solar Position
    Algorithm for Solar Radiations
    Applications</a>)</p>
</li>
<li>
<p>Difference between the sun's orientation and the river's orientation</p>
</li>
</ol>
<p>$$\theta = sun^{'}s\ azimuth\ angle\ (rad) - river^{'}s\ azimuth\ angle\ (rad)$$</p>
<ol>
<li>Calculate average shadow length based on average tree height</li>
</ol>
<blockquote>
<p>$$\omega = average\ shadow\ length$$</p>
<p>$$\tau = average\ tree\ height$$</p>
</blockquote>
<p>$$\varphi = solar\ altitude$$</p>
<p>$$\omega = \frac{\tau}{\tan(\varphi)}$$</p>
<ol>
<li>Calculate average shadow length perpendicular to the river</li>
</ol>
<p>$$\mu = average\ perpendicular\ shadow\ length\ $$</p>
<p>$$\mu = sin(\theta) \bullet \omega$$</p>
<ol>
<li>Shadow ratio covering the river</li>
</ol>
<p>$$\rho = shade\ ratio$$</p>
<p>$$\rho = \ \frac{\mu}{river\ width}$$</p>
<h2 id="lai-shading-algorithm">LAI Shading Algorithm<a class="headerlink" href="#lai-shading-algorithm" title="Permanent link">&para;</a></h2>
<h3 id="usage_2">Usage<a class="headerlink" href="#usage_2" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>Set <code>moduleOmbrage = 2</code></p>
</li>
<li>
<p>Obtain LAI data</p>
<ul>
<li>Data should be in the same format as weather data: [timesteps x
    CE]</li>
</ul>
</li>
<li>
<p>Normalize LAI data using the provided normalize_lai MATLAB function</p>
</li>
<li>
<p>Add normalized data into the struct:
    <code>struct.meteoPointGrille.lai_norm</code></p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c">% normalize LAI values based on given percentile</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="n">percentile</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">75</span><span class="p">;</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="n">structSMA</span><span class="p">.</span><span class="n">meteoPointGrille</span><span class="p">.</span><span class="n">lai_norm</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">normalize_lai</span><span class="p">(</span><span class="n">lai_data</span><span class="p">,</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="n">percentile</span><span class="p">);</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="n">structSMA</span><span class="p">.</span><span class="n">parametres</span><span class="p">.</span><span class="n">option</span><span class="p">.</span><span class="n">moduleOmbrage</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="p">[</span><span class="n">structSMA</span><span class="p">.</span><span class="n">etatsCE</span><span class="p">,</span><span class="w"> </span><span class="n">structSMA</span><span class="p">.</span><span class="n">etatsCP</span><span class="p">,</span><span class="w"> </span><span class="n">structSMA</span><span class="p">.</span><span class="n">etatsFonte</span><span class="p">,</span><span class="w"> </span><span class="n">structSMA</span><span class="p">.</span><span class="n">etatsEvapo</span><span class="p">,</span><span class="w"> </span><span class="n">structSMA</span><span class="p">.</span><span class="n">etatsBarrage</span><span class="p">,</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="n">structSMA</span><span class="p">.</span><span class="n">pasDeTemps</span><span class="p">,</span><span class="k">...</span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="n">structSMA</span><span class="p">.</span><span class="n">avantAssimilationsCE</span><span class="p">,</span><span class="w"> </span><span class="n">structSMA</span><span class="p">.</span><span class="n">avantAssimilationsFonte</span><span class="p">,</span>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="n">structSMA</span><span class="p">.</span><span class="n">avantAssimilationsEvapo</span><span class="p">,</span><span class="n">structSMA</span><span class="p">.</span><span class="n">etatsQualCP</span><span class="p">,</span><span class="w"> </span><span class="n">structSMA</span><span class="p">.</span><span class="n">avAssimQual</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">...</span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="n">cequeauQuantiteMex</span><span class="p">(</span><span class="n">structSMA</span><span class="p">.</span><span class="n">execution</span><span class="p">,</span><span class="w"> </span><span class="n">structSMA</span><span class="p">.</span><span class="n">parametres</span><span class="p">,</span>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="n">structSMA</span><span class="p">.</span><span class="n">bassinVersant</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="n">structSMA</span><span class="p">.</span><span class="n">meteoPointGrille</span><span class="p">,</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="p">[]);</span>
</code></pre></div>
<h3 id="algorithm_1">Algorithm<a class="headerlink" href="#algorithm_1" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>LAI data is normalized in a range from 0 to 1, based on a given
    percentile value.</p>
</li>
<li>
<p>The normalized LAI value is used to scale crayso
    (<code>struct.parametres.qualite.cequeau.temperat.crayso</code>)</p>
</li>
<li>
<p>The scaled crayso value is used to calculate solar radiation.</p>
</li>
</ol>
<h3 id="code">Code<a class="headerlink" href="#code" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1">// Example C++ logic snippet (illustrative)</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="kt">double</span><span class="w"> </span><span class="n">normalized_lai</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">meteoPointGrille</span><span class="p">.</span><span class="n">lai_norm</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"> </span><span class="c1">// Get normalized LAI for timestep i</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="c1">// Reduce the maximum effect to avoid excessive reduction</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">normalized_lai</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.8</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="w">    </span><span class="n">normalized_lai</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.8</span><span class="p">;</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="p">}</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="c1">// Scale the solar radiation coefficient</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="kt">double</span><span class="w"> </span><span class="n">original_crayso</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parametres</span><span class="p">.</span><span class="n">qualite</span><span class="p">.</span><span class="n">cequeau</span><span class="p">.</span><span class="n">temperat</span><span class="p">.</span><span class="n">crayso</span><span class="p">;</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="kt">double</span><span class="w"> </span><span class="n">scaled_crayso</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">original_crayso</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">normalized_lai</span><span class="p">);</span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="c1">// ... use scaled_crayso in subsequent solar radiation calculations ...</span>
</code></pre></div>
<p>The normalized LAI value is reduced to a maximum of 0.8 to prevent the
<code>scaled_crayso</code> to be reduced to less than 0. The <code>scaled_crayso</code> is then
used to calculate the solar radiation.</p>
<h1 id="qualite-time-steps">Qualite Time Steps<a class="headerlink" href="#qualite-time-steps" title="Permanent link">&para;</a></h1>
<h2 id="overview_2">Overview<a class="headerlink" href="#overview_2" title="Permanent link">&para;</a></h2>
<p>To use sub-daily time steps with the Cequeau Qualite module, the ipassim
variable in the input struct's option must be modified. The value can be
set to 1, 2, 3, 4, 6, 8, 12, and 24 (daily). This will change the time
steps for both the Quantite and Qualite module.</p>
<p>InputStruct.parametres.option.ipassim = 12;</p>
<p><em>Note: data assimilation is only available for daily time steps.</em></p>
<p>The calculQualite option must also be enabled to use the Qualite module.</p>
<p>InputStruct.parametres.option.calculQualite = 1;</p>
<p>It is also important to match simulated date range
(Struct.execution.dateDebut and Struct.execution.dateFin) to align with
the number of data points in the input structures, such as for
meteorological data and dam (barrage) data.</p>
<h2 id="example-usage">Example Usage:<a class="headerlink" href="#example-usage" title="Permanent link">&para;</a></h2>
<p>The file <code>cequeau/run/runCequeau_Qualite.m</code> demonstrates examples.</p>
<p>For now, testing file is linearly interpolating the input data
(<code>processInput.m</code>) to match the number of data points to test the
sub-daily water temperature model.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c">% Example from testing script</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="c">% every 12 hours</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="n">InputStruct12</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">processInput</span><span class="p">(</span><span class="n">InputStruct</span><span class="p">,</span><span class="w"> </span><span class="n">indices</span><span class="p">,</span><span class="w"> </span><span class="n">dateDebut</span><span class="p">,</span><span class="w"> </span><span class="n">dateFin</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">);</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="p">[</span><span class="n">y12</span><span class="p">.</span><span class="n">etatsCE</span><span class="p">,</span><span class="w"> </span><span class="n">y12</span><span class="p">.</span><span class="n">etatsCP</span><span class="p">,</span><span class="w"> </span><span class="n">y12</span><span class="p">.</span><span class="n">etatsFonte</span><span class="p">,</span><span class="w"> </span><span class="n">y12</span><span class="p">.</span><span class="n">etatsEvapo</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w"> </span><span class="n">y12</span><span class="p">.</span><span class="n">etatsBarrage</span><span class="p">,</span><span class="w"> </span><span class="n">y12</span><span class="p">.</span><span class="n">pasDeTemps</span><span class="p">,</span><span class="k">...</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="w"> </span><span class="n">y12</span><span class="p">.</span><span class="n">avantAssimilationsCE</span><span class="p">,</span><span class="w"> </span><span class="n">y12</span><span class="p">.</span><span class="n">avantAssimilationsFonte</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="w"> </span><span class="n">y12</span><span class="p">.</span><span class="n">avantAssimilationsEvapo</span><span class="p">,</span><span class="w"> </span><span class="n">y12</span><span class="p">.</span><span class="n">etatsQualCP</span><span class="p">,</span><span class="w"> </span><span class="n">y12</span><span class="p">.</span><span class="n">avAssimQual</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">...</span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="w">    </span><span class="n">cequeauQuantiteMex_test</span><span class="p">(</span><span class="n">InputStruct12</span><span class="p">.</span><span class="n">execution</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="w">                          </span><span class="n">InputStruct12</span><span class="p">.</span><span class="n">parametres</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="w">                          </span><span class="n">InputStruct12</span><span class="p">.</span><span class="n">bassinVersant</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="w">                          </span><span class="n">InputStruct12</span><span class="p">.</span><span class="n">meteoPointGrille</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="w">                          </span><span class="p">[],</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="p">[]);</span>
</code></pre></div>
<p>The same process was used to also simulate using a time step of 6. The
following graphs demonstrate the results compared to actual water
temperature from stations.</p>
<p><img alt="" src="/media/image3.png" /></p>
<p><img alt="" src="/media/image4.png" /></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tracking", "navigation.expand", "navigation.indexes", "navigation.tabs", "content.code.copy"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>