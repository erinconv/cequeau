
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the CEQUEAU hydrological model">
      
      
        <meta name="author" content="CEQUEAU Team">
      
      
        <link rel="canonical" href="https://erinconv.github.io/CEQUEAU/development/">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Purpose - CEQUEAU Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#purpose" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="CEQUEAU Documentation" class="md-header__button md-logo" aria-label="CEQUEAU Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CEQUEAU Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Purpose
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/erinconv/CEQUEAU" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    CEQUEAU Model
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href=".." class="md-tabs__link">
          
  
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../api/" class="md-tabs__link">
          
  
  
    
  
  API Documentation

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../CEQUEAU/annotated/" class="md-tabs__link">
          
  
  
    
  
  API Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="CEQUEAU Documentation" class="md-nav__button md-logo" aria-label="CEQUEAU Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    CEQUEAU Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/erinconv/CEQUEAU" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    CEQUEAU Model
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href=".." class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    License
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing to CEQUEAU
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../code_of_conduct/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code of Conduct for CEQUEAU Development
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Documentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API Documentation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/simulation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simulation Class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/bassin_versant/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    BassinVersant Class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/carreau_entier/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CarreauEntier Class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/carreau_partiel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CarreauPartiel Class
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CEQUEAU/annotated/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Class List
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="purpose">Purpose<a class="headerlink" href="#purpose" title="Permanent link">&para;</a></h1>
<p>This guide provides instructions for setting up the development
environment for Cequeau.</p>
<h1 id="folder-structure">Folder Structure<a class="headerlink" href="#folder-structure" title="Permanent link">&para;</a></h1>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>cequeau/
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>├── src/
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>├── tests/
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>├── docs/
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>└── mex/
</code></pre></div>
<p>The <code>src/</code> folder contains all header and source files for the C++ mex
function, and also the matlab and octave compilation files.</p>
<p>The <code>tests/</code> folder contains various folders to test functions and
features.</p>
<p>The <code>docs/</code> folder contains documentation for the development and usage of
Cequeau</p>
<p>The <code>mex/</code> the compiled mex binaries will be placed within this folder</p>
<h1 id="software-requirements">Software Requirements<a class="headerlink" href="#software-requirements" title="Permanent link">&para;</a></h1>
<p>The following section outlines the software and tools necessary to
develop and compile Cequeau. Cequeau can be compiled using both Matlab
and Octave.</p>
<h2 id="c-compiler">C++ Compiler<a class="headerlink" href="#c-compiler" title="Permanent link">&para;</a></h2>
<p>A C++ compiler that supports <strong>at least C++14</strong>.</p>
<h3 id="matlab">Matlab<a class="headerlink" href="#matlab" title="Permanent link">&para;</a></h3>
<p><img alt="" src="../media/image1.png" />
Matlab supports both GCC (MinGW) and MSVC,
with different supported compiler versions for each release. The
supported compilers can be found
<a href="https://www.mathworks.com/support/requirements/previous-releases.html"><strong>here</strong></a>,
within the compilers section.</p>
<h4 id="msvc-microsoft-visual-c">MSVC (Microsoft Visual C++)<a class="headerlink" href="#msvc-microsoft-visual-c" title="Permanent link">&para;</a></h4>
<p>MSVC is installed by installing Visual Studio with the "<strong>Desktop
development with C++</strong>" option enabled. The required Microsoft Visual
Studio version will depend on the Matlab version and its supported
compilers. For example, when using Matlab R2020b, which supports up to
Microsoft Visual C++ 2019, it requires Visual Studio 2019.</p>
<h4 id="gcc-mingw">GCC (MinGW)<a class="headerlink" href="#gcc-mingw" title="Permanent link">&para;</a></h4>
<p>MinGW-w64 is a GCC toolchain for the Windows platform. It can be
installed by following <a href="https://www.mathworks.com/matlabcentral/fileexchange/52848-matlab-support-for-mingw-w64-c-c-fortran-compiler">Mathwork\'s
guide</a>.</p>
<h3 id="octave">Octave<a class="headerlink" href="#octave" title="Permanent link">&para;</a></h3>
<p>Cequeau v5.0.0 was developed using Octave 9.4, and MinGW 13. A newer
version of octave and compiler will also satisfy the requirements and
compile the code.</p>
<p>The latest version of MinGW-w64 can be installed through MSYS2.</p>
<h1 id="compilation">Compilation<a class="headerlink" href="#compilation" title="Permanent link">&para;</a></h1>
<h3 id="compilation-in-matlab">Compilation in Matlab<a class="headerlink" href="#compilation-in-matlab" title="Permanent link">&para;</a></h3>
<p>The Matlab script to compile the C++ mex function is
<code>cequeau/src/compileCequeauMat.m</code>.</p>
<p>All relevant <code>.cpp</code> source files are appended to the <code>SOURCES</code> argument, if
a new file is to be added, it should be appended in a similar manner.</p>
<p>To ensure consistency, the C++ version is specified within the compile
arguments. As shown below, the script automatically detects the compiler
and sets the flags accordingly. <code>COMPFLAGS</code> is used for MSVC and <code>CXXFLAGS</code>
is used for GNU. More information about <code>mex</code> and the compiler flags can
be found here (<a href="https://www.mathworks.com/help/matlab/ref/mex.html">https://www.mathworks.com/help/matlab/ref/mex.html</a>).</p>
<p>To enable logging to the <code>.log</code> file, set the <code>log</code> variable to <code>true</code>.</p>
<p><img alt="" src="../media/image3.png" /></p>
<p>To enable debugging, the <code>-g</code> flag must be set, to do so, simply set the
<code>debug</code> variable to <code>true</code>.</p>
<p><img alt="" src="../media/image4.png" /></p>
<p>The output file is specified in the <code>OUTFILE</code> variable, by default the
compiled mex will be placed in <code>cequeau/mex/</code>.</p>
<p><img alt="" src="../media/image5.png" /></p>
<h3 id="compilation-in-octave">Compilation in Octave<a class="headerlink" href="#compilation-in-octave" title="Permanent link">&para;</a></h3>
<p>The compilation for octave is similar to the compilation in Matlab, with
only some syntactical differences. As shown below
(<code>cequeau/src/compileCequeauOct.m</code>).</p>
<p><img alt="" src="../media/image6.png" /></p>
<p>The <code>FLAGS</code> variable contains the custom flag <code>-DENV_OCTAVE</code>, which is
used within the cequeau program to detect whether it is the octave
version being run. This allows the ability to customize certain elements
depending on the environment. For example, it is used to append <code>Oct</code> or
<code>Mat</code> at the end of the log file to help the user identify the appropriate
log file.</p>
<h3 id="compilation-of-cequeau-interpolation">Compilation of Cequeau Interpolation<a class="headerlink" href="#compilation-of-cequeau-interpolation" title="Permanent link">&para;</a></h3>
<p>The interpolation compilation scripts (<code>compileInterpolationMat.m</code> and
<code>compileInterpolationOct.m</code>) are both similar to their respective Cequeau
Quantite compilation scripts, except they are targeting the source files
relevant for <code>InterpolationMex.cpp</code>.</p>
<h1 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">&para;</a></h1>
<p>Compiling the C++ code using Matlab or Octave mex creates a mex file
(<code>.mexw64</code> or <code>.mex</code>). This file is used as a Matlab/Octave function. It
takes in various inputs and the order matters, therefore if an input is
optional, it is still required to provide an empty array <code>[]</code> within the
input list. For detailed explanation about all of the inputs and
outputs, please refer to <code>'Intrants -- Extrants v5.docx'</code> and for a more
in depth usage guide, follow <code>'Cequeau_Guide.docx'</code>.</p>
<p>Here is an example usage:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="p">[</span><span class="n">y</span><span class="p">.</span><span class="n">etatsCE</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">.</span><span class="n">etatsCP</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">.</span><span class="n">etatsFonte</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">.</span><span class="n">etatsEvapo</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">.</span><span class="n">etatsBarrage</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w"> </span><span class="n">y</span><span class="p">.</span><span class="n">pasDeTemps</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">.</span><span class="n">avantAssimilationsCE</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">.</span><span class="n">avantAssimilationsFonte</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w"> </span><span class="n">y</span><span class="p">.</span><span class="n">avantAssimilationsEvapo</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">.</span><span class="n">etatsQualCP</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">.</span><span class="n">avAssimQual</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">...</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="n">cequeauQuantiteMat</span><span class="p">(</span><span class="nb">struct</span><span class="p">.</span><span class="n">execution</span><span class="p">,</span><span class="w"> </span><span class="nb">struct</span><span class="p">.</span><span class="n">parametres</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">                       </span><span class="nb">struct</span><span class="p">.</span><span class="n">bassinVersant</span><span class="p">,</span><span class="w"> </span><span class="nb">struct</span><span class="p">.</span><span class="n">meteo</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">                       </span><span class="nb">struct</span><span class="p">.</span><span class="n">etatsPrecedents</span><span class="p">,</span><span class="w"> </span><span class="nb">struct</span><span class="p">.</span><span class="n">assimilations</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">                       </span><span class="nb">struct</span><span class="p">.</span><span class="n">stations</span><span class="p">);</span>
</code></pre></div>
<p>After running this function, all of the outputs will be placed in the
variables provided in the left side of the function.</p>
<h1 id="logging-to-log-file">Logging to .log file<a class="headerlink" href="#logging-to-log-file" title="Permanent link">&para;</a></h1>
<p>A custom logger (<code>log.h</code>) was written to log data to a <code>.log</code> file during
testing. This feature is useful for quick testing and ensuring expected
functionality. It has various logging levels that can be used to print
out the desired type of information.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">enum</span><span class="w"> </span><span class="nc">TLogLevel</span><span class="w"> </span><span class="p">{</span><span class="n">logERROR</span><span class="p">,</span><span class="w"> </span><span class="n">logWARNING</span><span class="p">,</span><span class="w"> </span><span class="n">logINFO</span><span class="p">,</span><span class="w"> </span><span class="n">logDEBUG</span><span class="p">,</span><span class="w"> </span><span class="n">logDEBUG1</span><span class="p">,</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">               </span><span class="n">logDEBUG2</span><span class="p">,</span><span class="w"> </span><span class="n">logDEBUG3</span><span class="p">,</span><span class="w"> </span><span class="n">logDEBUG4</span><span class="p">};</span>
</code></pre></div>
<p>The logLevel is specified within the <code>cequeauQuantiteMex.cpp</code> file:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">FILELog</span><span class="o">::</span><span class="n">ReportingLevel</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">logINFO</span><span class="p">;</span><span class="w"> </span><span class="c1">// or logWarning, logError, logDebug, etc...</span>
</code></pre></div>
<h1 id="debugging">Debugging<a class="headerlink" href="#debugging" title="Permanent link">&para;</a></h1>
<p>The most convenient way to debug a mex program is using Visual Studio,
by attaching the process to the running matlab instance.</p>
<ol>
<li>
<p>Compile the Mex function with debug enabled</p>
<blockquote>
<p>Within the appropriate script to compile, set <code>debug</code> to <code>true</code>. After
compilation, there should be a <code>.pdb</code> file alongside the <code>.mex</code> file.</p>
</blockquote>
</li>
<li>
<p><img alt="" src="../media/image7.png" />
    Open visual studio and continue without code</p>
</li>
<li>
<p><img alt="" src="../media/image9.png" />
    Click the <code>Attach to Process...</code> button in the top
    toolbar (The exact icon/location might vary slightly)</p>
</li>
<li>
<p>Find and attach to the Matlab process (e.g., <code>MATLAB.exe</code>). You can use the filtering
    textbox for quick retrieval.</p>
<p><img alt="" src="../media/image11.png" /></p>
</li>
<li>
<p><img alt="" src="../media/image13.png" />
    Open the source file <code>cequeauQuantiteMex.cpp</code>. Go to <code>File -&gt; Open -&gt; File</code>, and locate the file that was compiled in the Matlab workspace.</p>
</li>
<li>
<p>Set a breakpoint at the entry point, <code>mexFunction()</code>. Right click on
    the line, <code>Breakpoint -&gt; Insert Breakpoint</code>.</p>
</li>
<li>
<p>Now go back to matlab, and run the function.</p>
</li>
<li>
<p>Visual Studio should display the function blocked at the breakpoint.</p>
</li>
<li>
<p><img alt="" src="../media/image14.png" />
    Disable <code>Access Violation</code> exceptions if they interrupt debugging unnecessarily. (Go to <code>Debug -&gt; Windows -&gt; Exception Settings</code> and uncheck <code>Common Language Runtime Exceptions -&gt; System.AccessViolationException</code> or similar, depending on VS version).</p>
</li>
<li>
<p>The program can now be debugged like any other C++ program, using
    <code>Step Into</code> (F11), <code>Step Over</code> (F10), <code>Continue</code> (F5), etc.</p>
</li>
</ol>
<h1 id="testing-matlab-and-octave">Testing Matlab and Octave<a class="headerlink" href="#testing-matlab-and-octave" title="Permanent link">&para;</a></h1>
<p>Cequeau v5.0.0 added support for Octave. To validate the octave compiled
version, test run files were created to ensure the Octave version
produced the same output as the Matlab version. The Matlab and Octave
versions are tested with the same inputs, and the outputs are compared
to ensure there are no differences.</p>
<p>The comparison testing is within <code>Cequeau/tests/testing_octave/</code></p>
<p>The <code>testing_octave/scripts/</code> folder contains Matlab and Octave scripts to
run the program with various configurations. For example,
<code>run_mat_fonte_0_Cequeau.m</code> tests the program with the Cequeau melting
module in Matlab. The <code>run_oct_fonte_0_Cequeau.m</code> is the octave
equivalent. Each of these files saves an output variable that is saved
as <code>.mat</code> files within the <code>testing_octave/outputs/</code> folder. The following
image demonstrates an example. The outputs are saved as v7 mat files
since that is the highest version supported by Octave.</p>
<p><img alt="" src="../media/image16.png" /></p>
<p><img alt="" src="../media/image17.png" />
Within the <code>testing_octave/</code> folder, the</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tracking", "navigation.expand", "navigation.indexes", "navigation.tabs", "content.code.copy"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>